<div class="dashboard">
  <div class="dash-header">
    <div>
      <h1 class="title">Dashboard</h1>
      <p class="subtitle">Welcome back! Here's what's happening with your ERP system.</p>
    </div>
    <div class="date">{{ getCurrentDate() }}</div>
  </div>

  <div class="kpi-grid">
    <div class="kpi-card kpi--lead" aria-label="Total Users: {{dashboardMetrics[0].value}}">
      <div class="kpi-head">
        <span class="kpi-label">Total Users ðŸ‘¥</span>
        <span class="icon-circle"></span>
      </div>
      <div class="kpi-value">{{ dashboardMetrics[0].value }}</div>
      <div class="kpi-change kpi-up">{{ dashboardMetrics[0].change }} vs last month</div>
    </div>
    
    <div class="kpi-card kpi--lead-approved" aria-label="Active Sessions: {{dashboardMetrics[1].value}}">
      <div class="kpi-head">
        <span class="kpi-label">Active Sessions âš¡</span>
        <span class="icon-circle"></span>
      </div>
      <div class="kpi-value">{{ dashboardMetrics[1].value }}</div>
      <div class="kpi-change kpi-up">{{ dashboardMetrics[1].change }} vs last month</div>
    </div>
    
    <div class="kpi-card kpi--quote" aria-label="System Uptime: {{dashboardMetrics[2].value}}">
      <div class="kpi-head">
        <span class="kpi-label">System Uptime ðŸš€</span>
        <span class="icon-circle"></span>
      </div>
      <div class="kpi-value">{{ dashboardMetrics[2].value }}</div>
      <div class="kpi-change kpi-up">{{ dashboardMetrics[2].change }} vs last month</div>
    </div>
    
    <div class="kpi-card kpi--contract" aria-label="Storage Used: {{dashboardMetrics[3].value}}">
      <div class="kpi-head">
        <span class="kpi-label">Storage Used ðŸ’¾</span>
        <span class="icon-circle"></span>
      </div>
      <div class="kpi-value">{{ dashboardMetrics[3].value }}</div>
      <div class="kpi-change kpi-neutral">{{ dashboardMetrics[3].change }} vs last month</div>
    </div>
  </div>

  <div class="content-grid">
    <div class="card chart-card">
      <div class="card-head">
        <h3>User Activity</h3>
        <div class="legend">
          <span class="dot is-blue"></span><span>Daily Active Users</span>
          <span class="dot is-green"></span><span>New Registrations</span>
          <span class="dot is-purple"></span><span>Page Views</span>
          <span class="dot is-yellow"></span><span>API Requests</span>
        </div>
      </div>
      <div class="chart-wrap">
        <svg class="bar-chart" viewBox="0 0 100 40" preserveAspectRatio="xMidYMid meet">
          <g *ngFor="let item of userActivityData; let i = index">
            <rect 
              [attr.x]="i * 22 + 5" 
              [attr.y]="40 - (item.value / getMaxActivityValue()) * 30" 
              [attr.width]="18" 
              [attr.height]="(item.value / getMaxActivityValue()) * 30"
              [class]="'bar ' + (i === 0 ? 'bar--blue' : i === 1 ? 'bar--green' : i === 2 ? 'bar--purple' : 'bar--yellow')">
            </rect>
            <text 
              [attr.x]="i * 22 + 14" 
              [attr.y]="38" 
              class="bar-label">
              {{ item.label.split(' ')[0] }}
            </text>
          </g>
        </svg>
      </div>
    </div>

    <div class="card">
      <h3>System Performance</h3>
      <table class="data-table">
        <tbody>
          <tr *ngFor="let perf of systemPerformance">
            <td class="metric">{{ perf.metric }}</td>
            <td class="value">{{ perf.value }}%</td>
            <td class="bar">
              <div class="perf-bar" 
                   [class.is-high]="perf.value >= 80" 
                   [class.is-mid]="perf.value >= 60 && perf.value < 80" 
                   [class.is-low]="perf.value < 60" 
                   [style.width.%]="perf.value">
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="bottom-grid">
    <div class="card list-card">
      <div class="card-head"><h3>Recent Activity</h3></div>
      <div class="list">
        <div class="list-item" *ngFor="let a of recentActivities">
          <span class="pill" 
                [class.is-blue]="a.type === 'user'" 
                [class.is-green]="a.type === 'role'" 
                [class.is-purple]="a.type === 'system'">
          </span>
          <div class="list-text">
            <div class="primary">{{ a.action }}</div>
            <div class="secondary">by {{ a.user }} â€¢ {{ a.timestamp }}</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card actions-card">
      <div class="card-head"><h3>Quick Actions</h3></div>
      <button class="action" *ngFor="let action of quickActions" [routerLink]="action.route">
        <span class="pill" 
              [class.is-blue]="action.title === 'Add New User'" 
              [class.is-green]="action.title === 'Create Role'" 
              [class.is-purple]="action.title === 'View Reports'" 
              [class.is-gray]="action.title === 'System Settings'">
        </span>
        <div>
          <div class="primary">{{ action.title }}</div>
          <div class="secondary">{{ action.description }}</div>
        </div>
      </button>
    </div>
  </div>

  <div class="recently-visited">
    <div class="rv-head">
      <h3>Recently Visited</h3>
      <a class="link">View all</a>
    </div>
    <div class="rv-grid">
      <a class="rv-card" *ngFor="let item of recentlyVisited" [routerLink]="item.route">
        <div class="rv-thumb"></div>
        <div class="rv-title">{{ item.title }}</div>
        <div class="rv-subtitle">{{ item.subtitle }}</div>
      </a>
    </div>
  </div>
</div>
